{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 Menlo-Regular;}
{\colortbl;\red255\green255\blue255;\red202\green202\blue202;\red23\green24\blue24;\red70\green137\blue204;
\red140\green211\blue254;\red109\green109\blue109;\red194\green126\blue101;\red109\green115\blue120;\red212\green212\blue212;
\red113\green192\blue131;\red167\green197\blue152;\red183\green111\blue247;\red54\green192\blue160;\red246\green124\blue48;
}
{\*\expandedcolortbl;;\cssrgb\c83137\c83137\c83137;\cssrgb\c11765\c12157\c12549;\cssrgb\c33725\c61176\c83922;
\cssrgb\c61176\c86275\c99608;\cssrgb\c50196\c50196\c50196;\cssrgb\c80784\c56863\c47059;\cssrgb\c50196\c52549\c54510;\cssrgb\c86275\c86275\c86275;
\cssrgb\c50588\c78824\c58431;\cssrgb\c70980\c80784\c65882;\cssrgb\c77255\c54118\c97647;\cssrgb\c23922\c78824\c69020;\cssrgb\c98039\c56471\c24314;
}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\fs28 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2     \cf4 \strokec4 <!DOCTYPE\cf5 \strokec5  html\cf4 \strokec4 >\cf2 \cb1 \strokec2 \
\cb3     \cf6 \strokec6 <\cf4 \strokec4 html\cf2 \strokec2  \cf5 \strokec5 lang\cf6 \strokec6 =\cf7 \strokec7 "it"\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3     \cf6 \strokec6 <\cf4 \strokec4 head\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3         \cf6 \strokec6 <\cf4 \strokec4 meta\cf2 \strokec2  \cf5 \strokec5 charset\cf6 \strokec6 =\cf7 \strokec7 "UTF-8"\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3         \cf6 \strokec6 <\cf4 \strokec4 meta\cf2 \strokec2  \cf5 \strokec5 name\cf6 \strokec6 =\cf7 \strokec7 "viewport"\cf2 \strokec2  \cf5 \strokec5 content\cf6 \strokec6 =\cf7 \strokec7 "width=device-width, initial-scale=1.0"\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3         \cf6 \strokec6 <\cf4 \strokec4 title\cf6 \strokec6 >\cf2 \strokec2 Flappy Fantasma\cf6 \strokec6 </\cf4 \strokec4 title\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3         \cf8 \strokec8 <!-- Tailwind CSS CDN per uno stile facile e responsivo -->\cf2 \cb1 \strokec2 \
\cb3         \cf6 \strokec6 <\cf4 \strokec4 script\cf2 \strokec2  \cf5 \strokec5 src\cf6 \strokec6 =\cf7 \strokec7 "https://cdn.tailwindcss.com"\cf6 \strokec6 ></\cf4 \strokec4 script\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3         \cf6 \strokec6 <\cf4 \strokec4 style\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3             \cf4 \strokec4 body\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 font-family:\cf2 \strokec2  \cf10 \strokec10 'Inter'\cf9 \strokec9 ,\cf2 \strokec2  \cf7 \strokec7 sans-serif\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 /* Font Inter */\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 background-color:\cf2 \strokec2  #1a202c\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 /* Colore di sfondo scuro */\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 display:\cf2 \strokec2  \cf7 \strokec7 flex\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 flex-direction:\cf2 \strokec2  \cf7 \strokec7 column\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 justify-content:\cf2 \strokec2  \cf7 \strokec7 center\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 align-items:\cf2 \strokec2  \cf7 \strokec7 center\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 min-height:\cf2 \strokec2  \cf11 \strokec11 100vh\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 margin:\cf2 \strokec2  \cf11 \strokec11 0\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 color:\cf2 \strokec2  #e2e8f0\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 /* Testo chiaro */\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 overflow:\cf2 \strokec2  \cf7 \strokec7 hidden\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 /* Evita lo scrolling */\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf4 \strokec4 canvas\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 /* Lo sfondo \'e8 disegnato via JS per l'effetto stellato */\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 border:\cf2 \strokec2  \cf11 \strokec11 2px\cf2 \strokec2  \cf7 \strokec7 solid\cf2 \strokec2  #e2e8f0\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 /* Bordo chiaro */\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 border-radius:\cf2 \strokec2  \cf11 \strokec11 8px\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 /* Bordi arrotondati */\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 display:\cf2 \strokec2  \cf7 \strokec7 block\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 touch-action:\cf2 \strokec2  \cf7 \strokec7 none\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 /* Impedisce lo scrolling sui dispositivi touch */\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 box-shadow:\cf2 \strokec2  \cf11 \strokec11 0\cf2 \strokec2  \cf11 \strokec11 0\cf2 \strokec2  \cf11 \strokec11 20px\cf2 \strokec2  \cf7 \strokec7 rgba(\cf11 \strokec11 0\cf9 \strokec9 ,\cf2 \strokec2  \cf11 \strokec11 255\cf9 \strokec9 ,\cf2 \strokec2  \cf11 \strokec11 0\cf9 \strokec9 ,\cf2 \strokec2  \cf11 \strokec11 0.5\cf7 \strokec7 )\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 /* Effetto neon verde */\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf4 \strokec4 .game-container\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 display:\cf2 \strokec2  \cf7 \strokec7 flex\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 flex-direction:\cf2 \strokec2  \cf7 \strokec7 column\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 align-items:\cf2 \strokec2  \cf7 \strokec7 center\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 gap:\cf2 \strokec2  \cf11 \strokec11 20px\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 padding:\cf2 \strokec2  \cf11 \strokec11 20px\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf4 \strokec4 .score-board\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 display:\cf2 \strokec2  \cf7 \strokec7 flex\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 justify-content:\cf2 \strokec2  \cf7 \strokec7 center\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 width:\cf2 \strokec2  \cf11 \strokec11 100%\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 max-width:\cf2 \strokec2  \cf11 \strokec11 600px\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 /* Adatta alla larghezza del canvas */\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 font-size:\cf2 \strokec2  \cf11 \strokec11 2.5rem\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 font-weight:\cf2 \strokec2  \cf7 \strokec7 bold\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 margin-bottom:\cf2 \strokec2  \cf11 \strokec11 10px\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 color:\cf2 \strokec2  #e2e8f0\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf4 \strokec4 .message-box\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 position:\cf2 \strokec2  \cf7 \strokec7 absolute\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 top:\cf2 \strokec2  \cf11 \strokec11 50%\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 left:\cf2 \strokec2  \cf11 \strokec11 50%\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 transform:\cf2 \strokec2  \cf7 \strokec7 translate(\cf11 \strokec11 -50%\cf9 \strokec9 ,\cf2 \strokec2  \cf11 \strokec11 -50%\cf7 \strokec7 )\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 background-color:\cf2 \strokec2  \cf7 \strokec7 rgba(\cf11 \strokec11 0\cf9 \strokec9 ,\cf2 \strokec2  \cf11 \strokec11 0\cf9 \strokec9 ,\cf2 \strokec2  \cf11 \strokec11 0\cf9 \strokec9 ,\cf2 \strokec2  \cf11 \strokec11 0.9\cf7 \strokec7 )\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 /* Sfondo pi\'f9 scuro per il messaggio */\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 border:\cf2 \strokec2  \cf11 \strokec11 2px\cf2 \strokec2  \cf7 \strokec7 solid\cf2 \strokec2  #e2e8f0\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 border-radius:\cf2 \strokec2  \cf11 \strokec11 10px\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 padding:\cf2 \strokec2  \cf11 \strokec11 30px\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 text-align:\cf2 \strokec2  \cf7 \strokec7 center\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 z-index:\cf2 \strokec2  \cf11 \strokec11 1000\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 display:\cf2 \strokec2  \cf7 \strokec7 none\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 flex-direction:\cf2 \strokec2  \cf7 \strokec7 column\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 gap:\cf2 \strokec2  \cf11 \strokec11 20px\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 box-shadow:\cf2 \strokec2  \cf11 \strokec11 0\cf2 \strokec2  \cf11 \strokec11 0\cf2 \strokec2  \cf11 \strokec11 15px\cf2 \strokec2  \cf7 \strokec7 rgba(\cf11 \strokec11 255\cf9 \strokec9 ,\cf2 \strokec2  \cf11 \strokec11 255\cf9 \strokec9 ,\cf2 \strokec2  \cf11 \strokec11 255\cf9 \strokec9 ,\cf2 \strokec2  \cf11 \strokec11 0.5\cf7 \strokec7 )\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf4 \strokec4 .message-box\cf2 \strokec2  \cf4 \strokec4 button\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 background-color:\cf2 \strokec2  #4a5568\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 color:\cf2 \strokec2  #e2e8f0\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 padding:\cf2 \strokec2  \cf11 \strokec11 12px\cf2 \strokec2  \cf11 \strokec11 25px\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 /* Pulsante pi\'f9 grande */\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 border-radius:\cf2 \strokec2  \cf11 \strokec11 8px\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 /* Bordi pi\'f9 arrotondati */\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 cursor:\cf2 \strokec2  \cf7 \strokec7 pointer\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 transition:\cf2 \strokec2  \cf7 \strokec7 background-color\cf2 \strokec2  \cf11 \strokec11 0.3s\cf2 \strokec2  \cf7 \strokec7 ease\cf9 \strokec9 ,\cf2 \strokec2  \cf7 \strokec7 transform\cf2 \strokec2  \cf11 \strokec11 0.2s\cf2 \strokec2  \cf7 \strokec7 ease\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 font-size:\cf2 \strokec2  \cf11 \strokec11 1.2rem\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 font-weight:\cf2 \strokec2  \cf7 \strokec7 bold\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 border:\cf2 \strokec2  \cf7 \strokec7 none\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 box-shadow:\cf2 \strokec2  \cf11 \strokec11 0\cf2 \strokec2  \cf11 \strokec11 4px\cf2 \strokec2  #2d3748\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 /* Ombra per effetto 3D */\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf4 \strokec4 .message-box\cf2 \strokec2  \cf4 \strokec4 button:hover:not\cf2 \strokec2 (\cf4 \strokec4 :disabled\cf2 \strokec2 ) \cf9 \strokec9 \{\cf2 \strokec2  \cf8 \strokec8 /* Aggiunto :not(:disabled) */\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 background-color:\cf2 \strokec2  #6a778e\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 transform:\cf2 \strokec2  \cf7 \strokec7 translateY(\cf11 \strokec11 -2px\cf7 \strokec7 )\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 box-shadow:\cf2 \strokec2  \cf11 \strokec11 0\cf2 \strokec2  \cf11 \strokec11 6px\cf2 \strokec2  #2d3748\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf4 \strokec4 .message-box\cf2 \strokec2  \cf4 \strokec4 button:active:not\cf2 \strokec2 (\cf4 \strokec4 :disabled\cf2 \strokec2 ) \cf9 \strokec9 \{\cf2 \strokec2  \cf8 \strokec8 /* Aggiunto :not(:disabled) */\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 transform:\cf2 \strokec2  \cf7 \strokec7 translateY(\cf11 \strokec11 2px\cf7 \strokec7 )\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 box-shadow:\cf2 \strokec2  \cf11 \strokec11 0\cf2 \strokec2  \cf11 \strokec11 2px\cf2 \strokec2  #2d3748\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf4 \strokec4 .message-box\cf2 \strokec2  \cf4 \strokec4 button:disabled\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \strokec2  \cf8 \strokec8 /* Stile per pulsante disabilitato */\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 background-color:\cf2 \strokec2  #2d3748\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 cursor:\cf2 \strokec2  \cf7 \strokec7 not-allowed\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 opacity:\cf2 \strokec2  \cf11 \strokec11 0.7\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf4 \strokec4 .controls-info\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 font-size:\cf2 \strokec2  \cf11 \strokec11 1rem\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 color:\cf2 \strokec2  #a0aec0\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 text-align:\cf2 \strokec2  \cf7 \strokec7 center\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf5 \strokec5 margin-top:\cf2 \strokec2  \cf11 \strokec11 10px\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3         \cf6 \strokec6 </\cf4 \strokec4 style\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3     \cf6 \strokec6 </\cf4 \strokec4 head\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3     \cf6 \strokec6 <\cf4 \strokec4 body\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3         \cf6 \strokec6 <\cf4 \strokec4 div\cf2 \strokec2  \cf5 \strokec5 class\cf6 \strokec6 =\cf7 \strokec7 "game-container"\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3             \cf6 \strokec6 <\cf4 \strokec4 h1\cf2 \strokec2  \cf5 \strokec5 class\cf6 \strokec6 =\cf7 \strokec7 "text-4xl font-extrabold text-white mb-4"\cf6 \strokec6 >\cf2 \strokec2 Flappy Fantasma\cf6 \strokec6 </\cf4 \strokec4 h1\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3             \cf6 \strokec6 <\cf4 \strokec4 div\cf2 \strokec2  \cf5 \strokec5 class\cf6 \strokec6 =\cf7 \strokec7 "score-board"\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3                 \cf6 \strokec6 <\cf4 \strokec4 span\cf2 \strokec2  \cf5 \strokec5 id\cf6 \strokec6 =\cf7 \strokec7 "score"\cf6 \strokec6 >\cf2 \strokec2 Punti: 0\cf6 \strokec6 </\cf4 \strokec4 span\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3             \cf6 \strokec6 </\cf4 \strokec4 div\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3             \cf6 \strokec6 <\cf4 \strokec4 canvas\cf2 \strokec2  \cf5 \strokec5 id\cf6 \strokec6 =\cf7 \strokec7 "gameCanvas"\cf6 \strokec6 ></\cf4 \strokec4 canvas\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3             \cf6 \strokec6 <\cf4 \strokec4 div\cf2 \strokec2  \cf5 \strokec5 class\cf6 \strokec6 =\cf7 \strokec7 "controls-info"\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3                 \cf6 \strokec6 <\cf4 \strokec4 p\cf6 \strokec6 >\cf2 \strokec2 Clicca, tocca lo schermo o premi 'F' per far volare il fantasma!\cf6 \strokec6 </\cf4 \strokec4 p\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3             \cf6 \strokec6 </\cf4 \strokec4 div\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3         \cf6 \strokec6 </\cf4 \strokec4 div\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\
\cb3         \cf6 \strokec6 <\cf4 \strokec4 div\cf2 \strokec2  \cf5 \strokec5 id\cf6 \strokec6 =\cf7 \strokec7 "messageBox"\cf2 \strokec2  \cf5 \strokec5 class\cf6 \strokec6 =\cf7 \strokec7 "message-box"\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3             \cf6 \strokec6 <\cf4 \strokec4 div\cf2 \strokec2  \cf5 \strokec5 id\cf6 \strokec6 =\cf7 \strokec7 "messageText"\cf2 \strokec2  \cf5 \strokec5 class\cf6 \strokec6 =\cf7 \strokec7 "text-2xl font-bold text-white"\cf6 \strokec6 ></\cf4 \strokec4 div\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3             \cf6 \strokec6 <\cf4 \strokec4 button\cf2 \strokec2  \cf5 \strokec5 id\cf6 \strokec6 =\cf7 \strokec7 "startButton"\cf6 \strokec6 >\cf2 \strokec2 Inizia Gioco\cf6 \strokec6 </\cf4 \strokec4 button\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3         \cf6 \strokec6 </\cf4 \strokec4 div\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\
\cb3         \cf6 \strokec6 <\cf4 \strokec4 script\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3             \cf8 \strokec8 // Variabili globali fornite dall'ambiente Canvas (non utilizzate in questo gioco, ma mantenute per consistenza)\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  appId \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 typeof\cf2 \strokec2  __app_id \cf9 \strokec9 !==\cf2 \strokec2  \cf10 \strokec10 'undefined'\cf2 \strokec2  \cf9 \strokec9 ?\cf2 \strokec2  __app_id \cf9 \strokec9 :\cf2 \strokec2  \cf10 \strokec10 'default-app-id'\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  firebaseConfig \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 typeof\cf2 \strokec2  __firebase_config \cf9 \strokec9 !==\cf2 \strokec2  \cf10 \strokec10 'undefined'\cf2 \strokec2  \cf9 \strokec9 ?\cf2 \strokec2  \cf13 \strokec13 JSON\cf9 \strokec9 .\cf2 \strokec2 parse\cf9 \strokec9 (\cf2 \strokec2 __firebase_config\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 :\cf2 \strokec2  \cf9 \strokec9 \{\};\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  initialAuthToken \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 typeof\cf2 \strokec2  __initial_auth_token \cf9 \strokec9 !==\cf2 \strokec2  \cf10 \strokec10 'undefined'\cf2 \strokec2  \cf9 \strokec9 ?\cf2 \strokec2  __initial_auth_token \cf9 \strokec9 :\cf2 \strokec2  \cf12 \strokec12 null\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\
\cb3             \cf8 \strokec8 // Costanti di gioco\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 600\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 400\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 GAME_OVERALL_SLOWDOWN_FACTOR\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0.80\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Velocit\'e0 generale del gioco ridotta del 20%\cf2 \cb1 \strokec2 \
\cb3             \cb1 \
\cb3             \cf8 \strokec8 // Valori base per le meccaniche di gioco (prima di eventuali moltiplicatori generali o specifici per livello)\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 BASE_GRAVITY\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 (((\cf14 \strokec14 0.5\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.7\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.84\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.90\cf9 \strokec9 );\cf2 \strokec2  \cb1 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 BASE_FLAP_STRENGTH\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 -\cf14 \strokec14 8\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.8\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\cb3             \cf8 \strokec8 // Aumentato il fantasma protagonista del 20%\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 (\cf14 \strokec14 40\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 1.20\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 (\cf14 \strokec14 30\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 1.20\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 PIPE_WIDTH\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 60\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf8 \strokec8 // Spazio tra il tubo superiore e inferiore: (((120 * 1.15) * 0.80) * 1.09) * 0.90\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 PIPE_GAP\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 108.3024\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Ridotto del 10%\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 BASE_PIPE_SPEED\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 3\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf9 \strokec9 (\cf14 \strokec14 1\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf14 \strokec14 0.13\cf9 \strokec9 );\cf2 \strokec2  \cb1 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 PIPE_INTERVAL\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 1500\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\cb3             \cf8 \strokec8 // Ritardo per dare tempo all'animazione di completarsi, aggiornato a 2000ms\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 WIN_MESSAGE_DELAY\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 2000\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 BASE_PINK_GHOST_SPEED\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Velocit\'e0 base per il fantasma rosa nell'animazione di vittoria\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 CHILD_GHOST_SIZE_FACTOR\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0.6\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // I fantasmi figli sono al 60% della dimensione dei fantasmi principali\cf2 \cb1 \strokec2 \
\
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 LEVEL_GOALS\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [\cf14 \strokec14 10\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 40\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 100\cf9 \strokec9 ];\cf2 \strokec2  \cf8 \strokec8 // Obiettivi di punteggio per Livello 1, 2, 3\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 LEVEL_SPEED_INCREASE_FACTOR\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 1.05\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Ogni livello successivo \'e8 il 5% pi\'f9 veloce\cf2 \cb1 \strokec2 \
\
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 PIPE_COLORS_PALETTE\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [\cf2 \cb1 \strokec2 \
\cb3                 \cf10 \strokec10 '#2d3748'\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Grigio scuro (originale)\cf2 \cb1 \strokec2 \
\cb3                 \cf10 \strokec10 '#4299e1'\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Blu\cf2 \cb1 \strokec2 \
\cb3                 \cf10 \strokec10 '#38a169'\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Verde\cf2 \cb1 \strokec2 \
\cb3                 \cf10 \strokec10 '#e53e3e'\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Rosso\cf2 \cb1 \strokec2 \
\cb3                 \cf10 \strokec10 '#9f7aea'\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Viola\cf2 \cb1 \strokec2 \
\cb3                 \cf10 \strokec10 '#ecc94b'\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Giallo\cf2 \cb1 \strokec2 \
\cb3                 \cf10 \strokec10 '#ed8936'\cf2 \strokec2   \cf8 \strokec8 // Arancione\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 ];\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 // Riferimenti agli elementi DOM\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  canvas \cf9 \strokec9 =\cf2 \strokec2  document\cf9 \strokec9 .\cf2 \strokec2 getElementById\cf9 \strokec9 (\cf10 \strokec10 'gameCanvas'\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  ctx \cf9 \strokec9 =\cf2 \strokec2  canvas\cf9 \strokec9 .\cf2 \strokec2 getContext\cf9 \strokec9 (\cf10 \strokec10 '2d'\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  scoreElem \cf9 \strokec9 =\cf2 \strokec2  document\cf9 \strokec9 .\cf2 \strokec2 getElementById\cf9 \strokec9 (\cf10 \strokec10 'score'\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  messageBox \cf9 \strokec9 =\cf2 \strokec2  document\cf9 \strokec9 .\cf2 \strokec2 getElementById\cf9 \strokec9 (\cf10 \strokec10 'messageBox'\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  messageText \cf9 \strokec9 =\cf2 \strokec2  document\cf9 \strokec9 .\cf2 \strokec2 getElementById\cf9 \strokec9 (\cf10 \strokec10 'messageText'\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  startButton \cf9 \strokec9 =\cf2 \strokec2  document\cf9 \strokec9 .\cf2 \strokec2 getElementById\cf9 \strokec9 (\cf10 \strokec10 'startButton'\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 // Variabili di velocit\'e0 dinamiche (impostate in startGame in base al livello)\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 let\cf2 \strokec2  currentGravity\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 let\cf2 \strokec2  currentFlapStrength\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 let\cf2 \strokec2  currentPipeSpeed\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 let\cf2 \strokec2  currentStarScrollSpeed\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 let\cf2 \strokec2  currentPinkGhostSpeed\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 let\cf2 \strokec2  currentPipeColor\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Conterr\'e0 il colore scelto casualmente per i tubi\cf2 \cb1 \strokec2 \
\
\cb3             \cf12 \strokec12 let\cf2 \strokec2  player \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 x\cf9 \strokec9 :\cf2 \strokec2  \cf14 \strokec14 50\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                 y\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                 dy\cf9 \strokec9 :\cf2 \strokec2  \cf14 \strokec14 0\cf2 \strokec2  \cf8 \strokec8 // Velocit\'e0 verticale\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \};\cf2 \cb1 \strokec2 \
\
\cb3             \cf12 \strokec12 let\cf2 \strokec2  pipes \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [];\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 let\cf2 \strokec2  score \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 let\cf2 \strokec2  lives \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 3\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Numero di vite iniziali, ridotto a 3\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 let\cf2 \strokec2  animationFrameId\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3             \cf12 \strokec12 let\cf2 \strokec2  stars \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [];\cf2 \strokec2  \cf8 \strokec8 // Array per le stelle\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 NUM_SMALL_STARS\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 150\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Numero di stelle piccole\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 NUM_LARGE_STARS\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 floor\cf9 \strokec9 (\cf13 \strokec13 NUM_SMALL_STARS\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.10\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // 10% di stelle grandi (15 stelle)\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 MAX_SMALL_STAR_OUTER_RADIUS\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Raggio esterno massimo per le stelle piccole\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 MAX_LARGE_STAR_OUTER_RADIUS\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 MAX_SMALL_STAR_OUTER_RADIUS\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Raggio esterno massimo per le stelle grandi\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 // Nuovi elementi per l'animazione della schermata di vittoria\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 let\cf2 \strokec2  pinkGhost \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \strokec2  x\cf9 \strokec9 :\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  y\cf9 \strokec9 :\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  speed\cf9 \strokec9 :\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  activated\cf9 \strokec9 :\cf2 \strokec2  \cf12 \strokec12 false\cf2 \strokec2  \cf9 \strokec9 \};\cf2 \strokec2  \cf8 \strokec8 // Fantasma rosa per la schermata di vittoria, la velocit\'e0 verr\'e0 impostata dinamicamente\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 let\cf2 \strokec2  hearts \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [];\cf2 \strokec2  \cf8 \strokec8 // Array per memorizzare le particelle a forma di cuore\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 let\cf2 \strokec2  winMessageDelayTimer \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 null\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Timer per controllare quando appare la casella del messaggio di vittoria\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 let\cf2 \strokec2  childGhosts \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [];\cf2 \strokec2  \cf8 \strokec8 // Per l'animazione della vittoria finale\cf2 \cb1 \strokec2 \
\
\cb3             \cf12 \strokec12 let\cf2 \strokec2  currentLevel \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 // Nuovi stati del gioco per una gestione pi\'f9 precisa\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 const\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf2 \strokec2  \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf13 \strokec13 IDLE\cf9 \strokec9 :\cf2 \strokec2  \cf10 \strokec10 'idle'\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Schermata iniziale, in attesa di "Inizia Gioco"\cf2 \cb1 \strokec2 \
\cb3                 \cf13 \strokec13 PENDING_START\cf9 \strokec9 :\cf2 \strokec2  \cf10 \strokec10 'pending_start'\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Gioco configurato, in attesa del primo flap per iniziare a giocare\cf2 \cb1 \strokec2 \
\cb3                 \cf13 \strokec13 PLAYING\cf9 \strokec9 :\cf2 \strokec2  \cf10 \strokec10 'playing'\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Il gioco \'e8 in corso\cf2 \cb1 \strokec2 \
\cb3                 \cf13 \strokec13 LEVEL_WIN_ANIMATION\cf9 \strokec9 :\cf2 \strokec2  \cf10 \strokec10 'level_win_animation'\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Animazione di vittoria di livello in corso\cf2 \cb1 \strokec2 \
\cb3                 \cf13 \strokec13 FINAL_WIN_ANIMATION\cf9 \strokec9 :\cf2 \strokec2  \cf10 \strokec10 'final_win_animation'\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Animazione di vittoria finale in corso\cf2 \cb1 \strokec2 \
\cb3                 \cf13 \strokec13 GAME_OVER_MESSAGE\cf9 \strokec9 :\cf2 \strokec2  \cf10 \strokec10 'game_over_message'\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Messaggio di Game Over (vite rimanenti), in attesa di input\cf2 \cb1 \strokec2 \
\cb3                 \cf13 \strokec13 RESTART_COUNTDOWN\cf9 \strokec9 :\cf2 \strokec2  \cf10 \strokec10 'restart_countdown'\cf2 \strokec2  \cf8 \strokec8 // Game Over (zero vite), conto alla rovescia per il riavvio completo\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \};\cf2 \cb1 \strokec2 \
\
\cb3             \cf12 \strokec12 let\cf2 \strokec2  gameStatus \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 IDLE\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Inizializza con lo stato di inattivit\'e0\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 let\cf2 \strokec2  lastPipeTime \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Inizializzazione per evitare ReferenceError\cf2 \cb1 \strokec2 \
\
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Crea una nuova particella a forma di cuore.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @returns \{object\} Un oggetto cuore con posizione, dimensione, velocit\'e0 e opacit\'e0.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  createHeart\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  size \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 8\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 4\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Dimensione tra 4 e 12\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 return\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     x\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                     y\cf9 \strokec9 :\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2 size\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Inizia sopra il canvas\cf2 \cb1 \strokec2 \
\cb3                     size\cf9 \strokec9 :\cf2 \strokec2  size\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                     dx\cf9 \strokec9 :\cf2 \strokec2  \cf9 \strokec9 (\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf14 \strokec14 0.5\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Lieve deriva orizzontale\cf2 \cb1 \strokec2 \
\cb3                     dy\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 2\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Velocit\'e0 di caduta\cf2 \cb1 \strokec2 \
\cb3                     opacity\cf9 \strokec9 :\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                     color\cf9 \strokec9 :\cf2 \strokec2  \cf10 \strokec10 '255, 105, 180'\cf2 \strokec2  \cf8 \strokec8 // Colore rosa in RGB\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \};\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Disegna una particella a forma di cuore stilizzata.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{number\} x - Coordinata X del centro del cuore.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{number\} y - Coordinata Y del centro del cuore.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{number\} size - Dimensione del cuore.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{string\} color - Colore del cuore (es. '255, 105, 180' per rosa).\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{number\} opacity - Opacit\'e0 del cuore (0-1).\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  drawHeart\cf9 \strokec9 (\cf2 \strokec2 x\cf9 \strokec9 ,\cf2 \strokec2  y\cf9 \strokec9 ,\cf2 \strokec2  size\cf9 \strokec9 ,\cf2 \strokec2  color\cf9 \strokec9 ,\cf2 \strokec2  opacity\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fillStyle \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 `rgba(\cf9 \strokec9 $\{\cf2 \strokec2 color\cf9 \strokec9 \}\cf10 \strokec10 , \cf9 \strokec9 $\{\cf2 \strokec2 opacity\cf9 \strokec9 \}\cf10 \strokec10 )`\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 beginPath\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 moveTo\cf9 \strokec9 (\cf2 \strokec2 x\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  size \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 4\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Inizia dal punto in basso del cuore\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 bezierCurveTo\cf9 \strokec9 (\cf2 \cb1 \strokec2 \
\cb3                     x \cf9 \strokec9 +\cf2 \strokec2  size \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 -\cf2 \strokec2  size \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2     \cf8 \strokec8 // Punto di controllo 1 (in alto a destra)\cf2 \cb1 \strokec2 \
\cb3                     x \cf9 \strokec9 +\cf2 \strokec2  size\cf9 \strokec9 ,\cf2 \strokec2  y\cf9 \strokec9 ,\cf2 \strokec2                  \cf8 \strokec8 // Punto di controllo 2 (a met\'e0 a destra)\cf2 \cb1 \strokec2 \
\cb3                     x\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  size                  \cf8 \strokec8 // Punto finale (di nuovo il punto in basso)\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 bezierCurveTo\cf9 \strokec9 (\cf2 \cb1 \strokec2 \
\cb3                     x \cf9 \strokec9 -\cf2 \strokec2  size\cf9 \strokec9 ,\cf2 \strokec2  y\cf9 \strokec9 ,\cf2 \strokec2                  \cf8 \strokec8 // Punto di controllo 3 (a met\'e0 a sinistra)\cf2 \cb1 \strokec2 \
\cb3                     x \cf9 \strokec9 -\cf2 \strokec2  size \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 -\cf2 \strokec2  size \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2     \cf8 \strokec8 // Punto di controllo 4 (in alto a sinistra)\cf2 \cb1 \strokec2 \
\cb3                     x\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  size \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 4\cf2 \strokec2               \cf8 \strokec8 // Punto finale (di nuovo l'inizio)\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 closePath\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fill\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Disegna una stella a 5 punte.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{object\} ctx - Il contesto di rendering 2D del canvas.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{number\} cx - Coordinata X del centro della stella.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{number\} cy - Coordinata Y del centro della stella.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{number\} outerRadius - Raggio esterno della stella.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{number\} innerRadius - Raggio interno della stella.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{string\} color - Colore della stella.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{number\} rotation - Rotazione della stella in radianti.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  drawStar\cf9 \strokec9 (\cf2 \strokec2 ctx\cf9 \strokec9 ,\cf2 \strokec2  cx\cf9 \strokec9 ,\cf2 \strokec2  cy\cf9 \strokec9 ,\cf2 \strokec2  outerRadius\cf9 \strokec9 ,\cf2 \strokec2  innerRadius\cf9 \strokec9 ,\cf2 \strokec2  color\cf9 \strokec9 ,\cf2 \strokec2  rotation \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 let\cf2 \strokec2  rot \cf9 \strokec9 =\cf2 \strokec2  rotation\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 let\cf2 \strokec2  x\cf9 \strokec9 ,\cf2 \strokec2  y\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fillStyle \cf9 \strokec9 =\cf2 \strokec2  color\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 beginPath\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\
\cb3                 \cf12 \strokec12 for\cf2 \strokec2  \cf9 \strokec9 (\cf12 \strokec12 let\cf2 \strokec2  i \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \strokec2  i \cf9 \strokec9 <\cf2 \strokec2  \cf14 \strokec14 5\cf9 \strokec9 ;\cf2 \strokec2  i\cf9 \strokec9 ++)\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     x \cf9 \strokec9 =\cf2 \strokec2  cx \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 cos\cf9 \strokec9 (\cf2 \strokec2 rot\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  outerRadius\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     y \cf9 \strokec9 =\cf2 \strokec2  cy \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 sin\cf9 \strokec9 (\cf2 \strokec2 rot\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  outerRadius\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     ctx\cf9 \strokec9 .\cf2 \strokec2 lineTo\cf9 \strokec9 (\cf2 \strokec2 x\cf9 \strokec9 ,\cf2 \strokec2  y\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                     rot \cf9 \strokec9 +=\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 5\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3                     x \cf9 \strokec9 =\cf2 \strokec2  cx \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 cos\cf9 \strokec9 (\cf2 \strokec2 rot\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  innerRadius\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     y \cf9 \strokec9 =\cf2 \strokec2  cy \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 sin\cf9 \strokec9 (\cf2 \strokec2 rot\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  innerRadius\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     ctx\cf9 \strokec9 .\cf2 \strokec2 lineTo\cf9 \strokec9 (\cf2 \strokec2 x\cf9 \strokec9 ,\cf2 \strokec2  y\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                     rot \cf9 \strokec9 +=\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 5\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 closePath\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fill\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Genera posizioni e propriet\'e0 casuali per le stelle nello sfondo.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  generateStars\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 stars \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [];\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 // Genera stelle piccole\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 for\cf2 \strokec2  \cf9 \strokec9 (\cf12 \strokec12 let\cf2 \strokec2  i \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \strokec2  i \cf9 \strokec9 <\cf2 \strokec2  \cf13 \strokec13 NUM_SMALL_STARS\cf9 \strokec9 ;\cf2 \strokec2  i\cf9 \strokec9 ++)\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     stars\cf9 \strokec9 .\cf2 \strokec2 push\cf9 \strokec9 (\{\cf2 \cb1 \strokec2 \
\cb3                         x\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                         y\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                         outerRadius\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf9 \strokec9 (\cf13 \strokec13 MAX_SMALL_STAR_OUTER_RADIUS\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf14 \strokec14 0.5\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 0.5\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Raggio esterno casuale tra 0.5 e MAX_SMALL_STAR_OUTER_RADIUS\cf2 \cb1 \strokec2 \
\cb3                         innerRadius\cf9 \strokec9 :\cf2 \strokec2  \cf9 \strokec9 (\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.5\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 0.2\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf9 \strokec9 (\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf9 \strokec9 (\cf13 \strokec13 MAX_SMALL_STAR_OUTER_RADIUS\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf14 \strokec14 0.5\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 0.5\cf9 \strokec9 ),\cf2 \strokec2  \cf8 \strokec8 // Raggio interno proporzionale\cf2 \cb1 \strokec2 \
\cb3                         speed\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.5\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 0.1\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Velocit\'e0 casuale per l'effetto parallasse\cf2 \cb1 \strokec2 \
\cb3                         rotation\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Rotazione casuale in radianti\cf2 \cb1 \strokec2 \
\cb3                         isLarge\cf9 \strokec9 :\cf2 \strokec2  \cf12 \strokec12 false\cf2 \strokec2  \cf8 \strokec8 // Contrassegna come stella piccola\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \});\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 // Genera stelle grandi\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 for\cf2 \strokec2  \cf9 \strokec9 (\cf12 \strokec12 let\cf2 \strokec2  i \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \strokec2  i \cf9 \strokec9 <\cf2 \strokec2  \cf13 \strokec13 NUM_LARGE_STARS\cf9 \strokec9 ;\cf2 \strokec2  i\cf9 \strokec9 ++)\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     stars\cf9 \strokec9 .\cf2 \strokec2 push\cf9 \strokec9 (\{\cf2 \cb1 \strokec2 \
\cb3                         x\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                         y\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                         outerRadius\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf9 \strokec9 (\cf13 \strokec13 MAX_LARGE_STAR_OUTER_RADIUS\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf13 \strokec13 MAX_SMALL_STAR_OUTER_RADIUS\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 MAX_SMALL_STAR_OUTER_RADIUS\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Raggio esterno casuale tra MAX_SMALL_STAR_OUTER_RADIUS e MAX_LARGE_STAR_OUTER_RADIUS\cf2 \cb1 \strokec2 \
\cb3                         innerRadius\cf9 \strokec9 :\cf2 \strokec2  \cf9 \strokec9 (\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.5\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 0.2\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf9 \strokec9 (\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf9 \strokec9 (\cf13 \strokec13 MAX_LARGE_STAR_OUTER_RADIUS\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf13 \strokec13 MAX_SMALL_STAR_OUTER_RADIUS\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 MAX_SMALL_STAR_OUTER_RADIUS\cf9 \strokec9 ),\cf2 \cb1 \strokec2 \
\cb3                         speed\cf9 \strokec9 :\cf2 \strokec2  \cf9 \strokec9 (\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.5\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 0.1\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 1.5\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Le stelle pi\'f9 grandi si muovono un po' pi\'f9 velocemente\cf2 \cb1 \strokec2 \
\cb3                         rotation\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                         isLarge\cf9 \strokec9 :\cf2 \strokec2  \cf12 \strokec12 true\cf2 \strokec2  \cf8 \strokec8 // Contrassegna come stella grande\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \});\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Disegna la forma di un fantasma.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{number\} x - Coordinata X dell'angolo superiore sinistro.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{number\} y - Coordinata Y del centro del fantasma.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{number\} width - Larghezza del fantasma.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{number\} height - Altezza del fantasma.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{string\} color - Colore del fantasma.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{string\} [direction='right'] - Direzione in cui guarda il fantasma ('left' o 'right').\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  drawGhost\cf9 \strokec9 (\cf2 \strokec2 x\cf9 \strokec9 ,\cf2 \strokec2  y\cf9 \strokec9 ,\cf2 \strokec2  width\cf9 \strokec9 ,\cf2 \strokec2  height\cf9 \strokec9 ,\cf2 \strokec2  color\cf9 \strokec9 ,\cf2 \strokec2  direction \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 'right'\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fillStyle \cf9 \strokec9 =\cf2 \strokec2  color\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 beginPath\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 // Parte superiore arrotondata\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 arc\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 3\cf9 \strokec9 ,\cf2 \strokec2  width \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 // Lati\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 lineTo\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 // Parte inferiore frastagliata\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 lineTo\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 5\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 6\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.9\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 lineTo\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 4\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 6\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 lineTo\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 3\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 6\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.9\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 lineTo\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 2\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 6\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 lineTo\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 1\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 6\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.9\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 lineTo\cf9 \strokec9 (\cf2 \strokec2 x\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 closePath\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fill\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\
\cb3                 \cf8 \strokec8 // Occhi (bianchi) - ingranditi e spostati in base alla direzione\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  eyeRadius \cf9 \strokec9 =\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.15\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fillStyle \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 'white'\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 beginPath\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 direction \cf9 \strokec9 ===\cf2 \strokec2  \cf10 \strokec10 'right'\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     ctx\cf9 \strokec9 .\cf2 \strokec2 arc\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.47\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.38\cf9 \strokec9 ,\cf2 \strokec2  eyeRadius\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Occhio sinistro (relativo)\cf2 \cb1 \strokec2 \
\cb3                     ctx\cf9 \strokec9 .\cf2 \strokec2 arc\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.82\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.38\cf9 \strokec9 ,\cf2 \strokec2  eyeRadius\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Occhio destro (relativo)\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \strokec2  \cf8 \strokec8 // direction === 'left'\cf2 \cb1 \strokec2 \
\cb3                     ctx\cf9 \strokec9 .\cf2 \strokec2 arc\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.18\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.38\cf9 \strokec9 ,\cf2 \strokec2  eyeRadius\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Occhio destro (relativo)\cf2 \cb1 \strokec2 \
\cb3                     ctx\cf9 \strokec9 .\cf2 \strokec2 arc\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.53\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.38\cf9 \strokec9 ,\cf2 \strokec2  eyeRadius\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Occhio sinistro (relativo)\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fill\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\
\cb3                 \cf8 \strokec8 // Pupille (nera) - ingrandite e spostate in base alla direzione\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  pupilRadius \cf9 \strokec9 =\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.08\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fillStyle \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 'black'\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 beginPath\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 direction \cf9 \strokec9 ===\cf2 \strokec2  \cf10 \strokec10 'right'\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     ctx\cf9 \strokec9 .\cf2 \strokec2 arc\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.52\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.38\cf9 \strokec9 ,\cf2 \strokec2  pupilRadius\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Pupilla sinistra (relativa)\cf2 \cb1 \strokec2 \
\cb3                     ctx\cf9 \strokec9 .\cf2 \strokec2 arc\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.77\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.38\cf9 \strokec9 ,\cf2 \strokec2  pupilRadius\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Pupilla destra (relativa)\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \strokec2  \cf8 \strokec8 // direction === 'left'\cf2 \cb1 \strokec2 \
\cb3                     ctx\cf9 \strokec9 .\cf2 \strokec2 arc\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.23\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.38\cf9 \strokec9 ,\cf2 \strokec2  pupilRadius\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Pupilla destra (relativa)\cf2 \cb1 \strokec2 \
\cb3                     ctx\cf9 \strokec9 .\cf2 \strokec2 arc\cf9 \strokec9 (\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  width \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.48\cf9 \strokec9 ,\cf2 \strokec2  y \cf9 \strokec9 +\cf2 \strokec2  height \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.38\cf9 \strokec9 ,\cf2 \strokec2  pupilRadius\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Pupilla sinistra (relativa)\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fill\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Disegna un tubo.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{object\} pipe - L'oggetto tubo.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  drawPipe\cf9 \strokec9 (\cf2 \strokec2 pipe\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fillStyle \cf9 \strokec9 =\cf2 \strokec2  currentPipeColor\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 /* Colore condotta (scelto casualmente) */\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 // Tubo superiore\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 roundRect\cf9 \strokec9 (\cf2 \strokec2 pipe\cf9 \strokec9 .\cf2 \strokec2 x\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  pipe\cf9 \strokec9 .\cf2 \strokec2 width\cf9 \strokec9 ,\cf2 \strokec2  pipe\cf9 \strokec9 .\cf2 \strokec2 height\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 5\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fill\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 // Tubo inferiore\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 roundRect\cf9 \strokec9 (\cf2 \strokec2 pipe\cf9 \strokec9 .\cf2 \strokec2 x\cf9 \strokec9 ,\cf2 \strokec2  pipe\cf9 \strokec9 .\cf2 \strokec2 height \cf9 \strokec9 +\cf2 \strokec2  pipe\cf9 \strokec9 .\cf2 \strokec2 gap\cf9 \strokec9 ,\cf2 \strokec2  pipe\cf9 \strokec9 .\cf2 \strokec2 width\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 pipe\cf9 \strokec9 .\cf2 \strokec2 height \cf9 \strokec9 +\cf2 \strokec2  pipe\cf9 \strokec9 .\cf2 \strokec2 gap\cf9 \strokec9 ),\cf2 \strokec2  \cf14 \strokec14 5\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fill\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Disegna tutti gli elementi del gioco sul canvas in base allo stato del gioco.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  draw\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 clearRect\cf9 \strokec9 (\cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Pulisci l'intero canvas\cf2 \cb1 \strokec2 \
\
\cb3                 \cf8 \strokec8 // Disegna lo sfondo del cielo stellato SEMPRE come primo strato\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fillStyle \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 '#1a202c'\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fillRect\cf9 \strokec9 (\cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\
\cb3                 \cf8 \strokec8 // Aggiorna e disegna le stelle per l'effetto parallasse SEMPRE\cf2 \cb1 \strokec2 \
\cb3                 ctx\cf9 \strokec9 .\cf2 \strokec2 fillStyle \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 'white'\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 stars\cf9 \strokec9 .\cf2 \strokec2 forEach\cf9 \strokec9 (\cf2 \strokec2 star \cf9 \strokec9 =>\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     star\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 -=\cf2 \strokec2  currentStarScrollSpeed \cf9 \strokec9 *\cf2 \strokec2  star\cf9 \strokec9 .\cf2 \strokec2 speed\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\cb3                     \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 star\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  star\cf9 \strokec9 .\cf2 \strokec2 outerRadius \cf9 \strokec9 <\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \strokec2  \cb1 \
\cb3                         star\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  star\cf9 \strokec9 .\cf2 \strokec2 outerRadius \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 50\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Ri-appare fuori schermo a destra\cf2 \cb1 \strokec2 \
\cb3                         star\cf9 \strokec9 .\cf2 \strokec2 y \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\cb3                         star\cf9 \strokec9 .\cf2 \strokec2 rotation \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                         \cb1 \
\cb3                         \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 star\cf9 \strokec9 .\cf2 \strokec2 isLarge\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \strokec2  \cf8 \strokec8 // Se era una stella grande, rigenerala come grande\cf2 \cb1 \strokec2 \
\cb3                             star\cf9 \strokec9 .\cf2 \strokec2 outerRadius \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf9 \strokec9 (\cf13 \strokec13 MAX_LARGE_STAR_OUTER_RADIUS\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf14 \strokec14 0.5\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 0.5\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                             star\cf9 \strokec9 .\cf2 \strokec2 innerRadius \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 (\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.5\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 0.2\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  star\cf9 \strokec9 .\cf2 \strokec2 outerRadius\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                             star\cf9 \strokec9 .\cf2 \strokec2 speed \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.5\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 0.1\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                         \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \strokec2  \cf8 \strokec8 // Era una stella piccola\cf2 \cb1 \strokec2 \
\cb3                             star\cf9 \strokec9 .\cf2 \strokec2 outerRadius \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf9 \strokec9 (\cf13 \strokec13 MAX_SMALL_STAR_OUTER_RADIUS\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf14 \strokec14 0.5\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 0.5\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                             star\cf9 \strokec9 .\cf2 \strokec2 innerRadius \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 (\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.5\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 0.2\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  star\cf9 \strokec9 .\cf2 \strokec2 outerRadius\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                             star\cf9 \strokec9 .\cf2 \strokec2 speed \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.5\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 0.1\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                         \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                     drawStar\cf9 \strokec9 (\cf2 \strokec2 ctx\cf9 \strokec9 ,\cf2 \strokec2  star\cf9 \strokec9 .\cf2 \strokec2 x\cf9 \strokec9 ,\cf2 \strokec2  star\cf9 \strokec9 .\cf2 \strokec2 y\cf9 \strokec9 ,\cf2 \strokec2  star\cf9 \strokec9 .\cf2 \strokec2 outerRadius\cf9 \strokec9 ,\cf2 \strokec2  star\cf9 \strokec9 .\cf2 \strokec2 innerRadius\cf9 \strokec9 ,\cf2 \strokec2  \cf10 \strokec10 'white'\cf9 \strokec9 ,\cf2 \strokec2  star\cf9 \strokec9 .\cf2 \strokec2 rotation\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Passa ctx a drawStar\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \});\cf2 \cb1 \strokec2 \
\
\cb3                 \cf8 \strokec8 // Disegna gli elementi specifici del gioco (tubi, giocatore, fantasmi dell'animazione di vittoria) condizionalmente\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 PLAYING\cf2 \strokec2  \cf9 \strokec9 ||\cf2 \strokec2  gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 IDLE\cf2 \strokec2  \cf9 \strokec9 ||\cf2 \strokec2  gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 PENDING_START\cf2 \strokec2  \cf9 \strokec9 ||\cf2 \strokec2  gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 GAME_OVER_MESSAGE\cf2 \strokec2  \cf9 \strokec9 ||\cf2 \strokec2  gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 RESTART_COUNTDOWN\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     pipes\cf9 \strokec9 .\cf2 \strokec2 forEach\cf9 \strokec9 (\cf2 \strokec2 drawPipe\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Disegna tutti i tubi\cf2 \cb1 \strokec2 \
\cb3                     drawGhost\cf9 \strokec9 (\cf2 \strokec2 player\cf9 \strokec9 .\cf2 \strokec2 x\cf9 \strokec9 ,\cf2 \strokec2  player\cf9 \strokec9 .\cf2 \strokec2 y\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf9 \strokec9 ,\cf2 \strokec2  \cf10 \strokec10 '#e53e3e'\cf9 \strokec9 ,\cf2 \strokec2  \cf10 \strokec10 'right'\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Disegna il fantasma rosso\cf2 \cb1 \strokec2 \
\
\cb3                 \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 LEVEL_WIN_ANIMATION\cf2 \strokec2  \cf9 \strokec9 ||\cf2 \strokec2  gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 FINAL_WIN_ANIMATION\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     \cf8 \strokec8 // Disegna il fantasma giocatore centrato\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 const\cf2 \strokec2  centerX \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 const\cf2 \strokec2  centerY \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     drawGhost\cf9 \strokec9 (\cf2 \strokec2 centerX\cf9 \strokec9 ,\cf2 \strokec2  centerY\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf9 \strokec9 ,\cf2 \strokec2  \cf10 \strokec10 '#e53e3e'\cf9 \strokec9 ,\cf2 \strokec2  \cf10 \strokec10 'right'\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Il fantasma rosso guarda a destra\cf2 \cb1 \strokec2 \
\
\cb3                     \cf8 \strokec8 // Disegna il fantasma rosa (la direzione dipende dalla sua posizione rispetto al fantasma rosso)\cf2 \cb1 \strokec2 \
\cb3                     \cf8 \strokec8 // Se il fantasma rosa \'e8 alla destra del fantasma rosso, deve guardare a sinistra per "guardarlo"\cf2 \cb1 \strokec2 \
\cb3                     drawGhost\cf9 \strokec9 (\cf2 \strokec2 pinkGhost\cf9 \strokec9 .\cf2 \strokec2 x\cf9 \strokec9 ,\cf2 \strokec2  pinkGhost\cf9 \strokec9 .\cf2 \strokec2 y\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf9 \strokec9 ,\cf2 \strokec2  \cf10 \strokec10 'pink'\cf9 \strokec9 ,\cf2 \strokec2  \cf10 \strokec10 'left'\cf9 \strokec9 );\cf2 \strokec2  \cb1 \
\cb3                     \cb1 \
\cb3                     \cf8 \strokec8 // Disegna i fantasmi figli per l'animazione della vittoria finale\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 FINAL_WIN_ANIMATION\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                         childGhosts\cf9 \strokec9 .\cf2 \strokec2 forEach\cf9 \strokec9 (\cf2 \strokec2 child \cf9 \strokec9 =>\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                             \cf8 \strokec8 // Anche i fantasmi figli dovrebbero guardare a sinistra in questa animazione\cf2 \cb1 \strokec2 \
\cb3                             drawGhost\cf9 \strokec9 (\cf2 \strokec2 child\cf9 \strokec9 .\cf2 \strokec2 x\cf9 \strokec9 ,\cf2 \strokec2  child\cf9 \strokec9 .\cf2 \strokec2 y\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 CHILD_GHOST_SIZE_FACTOR\cf9 \strokec9 ,\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 CHILD_GHOST_SIZE_FACTOR\cf9 \strokec9 ,\cf2 \strokec2  child\cf9 \strokec9 .\cf2 \strokec2 color\cf9 \strokec9 ,\cf2 \strokec2  \cf10 \strokec10 'left'\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                         \cf9 \strokec9 \});\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3                     \cf8 \strokec8 // Disegna i cuoricini\cf2 \cb1 \strokec2 \
\cb3                     hearts\cf9 \strokec9 .\cf2 \strokec2 forEach\cf9 \strokec9 (\cf2 \strokec2 heart \cf9 \strokec9 =>\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                         drawHeart\cf9 \strokec9 (\cf2 \strokec2 heart\cf9 \strokec9 .\cf2 \strokec2 x\cf9 \strokec9 ,\cf2 \strokec2  heart\cf9 \strokec9 .\cf2 \strokec2 y\cf9 \strokec9 ,\cf2 \strokec2  heart\cf9 \strokec9 .\cf2 \strokec2 size\cf9 \strokec9 ,\cf2 \strokec2  heart\cf9 \strokec9 .\cf2 \strokec2 color\cf9 \strokec9 ,\cf2 \strokec2  heart\cf9 \strokec9 .\cf2 \strokec2 opacity\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \});\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Aggiorna lo stato del gioco.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  update\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 // La logica di aggiornamento si esegue solo se il gioco \'e8 nello stato PLAYING\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 gameStatus \cf9 \strokec9 !==\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 PLAYING\cf9 \strokec9 )\cf2 \strokec2  \cf12 \strokec12 return\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3                 \cf8 \strokec8 // Aggiorna la posizione del giocatore\cf2 \cb1 \strokec2 \
\cb3                 player\cf9 \strokec9 .\cf2 \strokec2 dy \cf9 \strokec9 +=\cf2 \strokec2  currentGravity\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 player\cf9 \strokec9 .\cf2 \strokec2 y \cf9 \strokec9 +=\cf2 \strokec2  player\cf9 \strokec9 .\cf2 \strokec2 dy\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3                 \cf8 \strokec8 // Limita la posizione del giocatore entro i bordi del canvas\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 player\cf9 \strokec9 .\cf2 \strokec2 y \cf9 \strokec9 <\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     player\cf9 \strokec9 .\cf2 \strokec2 y \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     player\cf9 \strokec9 .\cf2 \strokec2 dy \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 player\cf9 \strokec9 .\cf2 \strokec2 y \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf2 \strokec2  \cf9 \strokec9 >\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     player\cf9 \strokec9 .\cf2 \strokec2 y \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     endGame\cf9 \strokec9 (\cf10 \strokec10 'gameOver'\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Game over se tocca il suolo\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 return\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Esci per prevenire ulteriori aggiornamenti dopo il game over\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3                 \cf8 \strokec8 // Sposta e genera tubi\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  currentTime \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 Date\cf9 \strokec9 .\cf2 \strokec2 now\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 currentTime \cf9 \strokec9 -\cf2 \strokec2  lastPipeTime \cf9 \strokec9 >\cf2 \strokec2  \cf13 \strokec13 PIPE_INTERVAL\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     generatePipe\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                     lastPipeTime \cf9 \strokec9 =\cf2 \strokec2  currentTime\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3                 \cf12 \strokec12 for\cf2 \strokec2  \cf9 \strokec9 (\cf12 \strokec12 let\cf2 \strokec2  i \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \strokec2  i \cf9 \strokec9 <\cf2 \strokec2  pipes\cf9 \strokec9 .\cf2 \strokec2 length\cf9 \strokec9 ;\cf2 \strokec2  i\cf9 \strokec9 ++)\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 let\cf2 \strokec2  pipe \cf9 \strokec9 =\cf2 \strokec2  pipes\cf9 \strokec9 [\cf2 \strokec2 i\cf9 \strokec9 ];\cf2 \cb1 \strokec2 \
\cb3                     pipe\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 -=\cf2 \strokec2  currentPipeSpeed\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3                     \cf8 \strokec8 // Controlla il punteggio\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 pipe\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  pipe\cf9 \strokec9 .\cf2 \strokec2 width \cf9 \strokec9 <\cf2 \strokec2  player\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 &&\cf2 \strokec2  \cf9 \strokec9 !\cf2 \strokec2 pipe\cf9 \strokec9 .\cf2 \strokec2 passed\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                         score\cf9 \strokec9 ++;\cf2 \cb1 \strokec2 \
\cb3                         scoreElem\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 `Punti: \cf9 \strokec9 $\{\cf2 \strokec2 score\cf9 \strokec9 \}\cf10 \strokec10  / \cf9 \strokec9 $\{\cf13 \strokec13 LEVEL_GOALS\cf9 \strokec9 [\cf2 \strokec2 currentLevel \cf9 \strokec9 -\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 ]\}\cf10 \strokec10  (Livello \cf9 \strokec9 $\{\cf2 \strokec2 currentLevel\cf9 \strokec9 \}\cf10 \strokec10 ) Vite: \cf9 \strokec9 $\{\cf2 \strokec2 lives\cf9 \strokec9 \}\cf10 \strokec10 `\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                         pipe\cf9 \strokec9 .\cf2 \strokec2 passed \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 true\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                         \cf8 \strokec8 // Controlla la condizione di vittoria per il livello attuale\cf2 \cb1 \strokec2 \
\cb3                         \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 score \cf9 \strokec9 >=\cf2 \strokec2  \cf13 \strokec13 LEVEL_GOALS\cf9 \strokec9 [\cf2 \strokec2 currentLevel \cf9 \strokec9 -\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 ])\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                             \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 currentLevel \cf9 \strokec9 <\cf2 \strokec2  \cf13 \strokec13 LEVEL_GOALS\cf9 \strokec9 .\cf2 \strokec2 length\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                                 endGame\cf9 \strokec9 (\cf10 \strokec10 'levelWin'\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Livello completato\cf2 \cb1 \strokec2 \
\cb3                             \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                                 endGame\cf9 \strokec9 (\cf10 \strokec10 'finalWin'\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Vittoria finale\cf2 \cb1 \strokec2 \
\cb3                             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                             \cf12 \strokec12 return\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Esci per evitare ulteriori aggiornamenti dopo la vittoria/completamento del livello\cf2 \cb1 \strokec2 \
\cb3                         \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3                     \cf8 \strokec8 // Rimuovi i tubi fuori schermo\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 pipe\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  pipe\cf9 \strokec9 .\cf2 \strokec2 width \cf9 \strokec9 <\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                         pipes\cf9 \strokec9 .\cf2 \strokec2 splice\cf9 \strokec9 (\cf2 \strokec2 i\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                         i\cf9 \strokec9 --;\cf2 \strokec2  \cf8 \strokec8 // Decrementa l'indice per compensare la rimozione\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3                     \cf8 \strokec8 // Controlla le collisioni con i tubi\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \cb1 \strokec2 \
\cb3                         player\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 <\cf2 \strokec2  pipe\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  pipe\cf9 \strokec9 .\cf2 \strokec2 width \cf9 \strokec9 &&\cf2 \cb1 \strokec2 \
\cb3                         player\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf2 \strokec2  \cf9 \strokec9 >\cf2 \strokec2  pipe\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 &&\cf2 \cb1 \strokec2 \
\cb3                         \cf9 \strokec9 (\cf2 \strokec2 player\cf9 \strokec9 .\cf2 \strokec2 y \cf9 \strokec9 <\cf2 \strokec2  pipe\cf9 \strokec9 .\cf2 \strokec2 height \cf9 \strokec9 ||\cf2 \strokec2  player\cf9 \strokec9 .\cf2 \strokec2 y \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf2 \strokec2  \cf9 \strokec9 >\cf2 \strokec2  pipe\cf9 \strokec9 .\cf2 \strokec2 height \cf9 \strokec9 +\cf2 \strokec2  pipe\cf9 \strokec9 .\cf2 \strokec2 gap\cf9 \strokec9 )\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                         endGame\cf9 \strokec9 (\cf10 \strokec10 'gameOver'\cf9 \strokec9 );\cf2 \strokec2  \cf8 \strokec8 // Collisione con il tubo\cf2 \cb1 \strokec2 \
\cb3                         \cf12 \strokec12 return\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Esci per evitare ulteriori aggiornamenti dopo il game over\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Aggiorna gli elementi specifici dell'animazione della schermata di vittoria.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  updateWinScreen\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  centerX \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  centerY \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  redGhostX \cf9 \strokec9 =\cf2 \strokec2  centerX\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  redGhostY \cf9 \strokec9 =\cf2 \strokec2  centerY\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3                 \cf8 \strokec8 // Posizione target per il fantasma rosa per fermarsi a destra del fantasma rosso, guardando a sinistra\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  pinkGhostTargetX \cf9 \strokec9 =\cf2 \strokec2  redGhostX \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 5\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\
\cb3                 \cf12 \strokec12 let\cf2 \strokec2  ghostsAnimationDone \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 true\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3                 \cf8 \strokec8 // Aggiorna la posizione del fantasma rosa (si muove sia per Level Win che per Final Win)\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (!\cf2 \strokec2 pinkGhost\cf9 \strokec9 .\cf2 \strokec2 activated\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     \cf8 \strokec8 // Si muove da destra a sinistra (x diminuisce)\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 pinkGhost\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 >\cf2 \strokec2  pinkGhostTargetX\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                         pinkGhost\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 -=\cf2 \strokec2  currentPinkGhostSpeed\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                         ghostsAnimationDone \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Il fantasma rosa si sta ancora muovendo\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                         pinkGhost\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 =\cf2 \strokec2  pinkGhostTargetX\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                         pinkGhost\cf9 \strokec9 .\cf2 \strokec2 activated \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 true\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Il fantasma rosa \'e8 arrivato\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 \cb1 \
\cb3                 \cf8 \strokec8 // I fantasmi figli seguono il fantasma rosa (solo per FINAL_WIN_ANIMATION)\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 // I fantasmi figli si muovono da destra a sinistra e si fermano a destra del fantasma rosa\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 FINAL_WIN_ANIMATION\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     childGhosts\cf9 \strokec9 .\cf2 \strokec2 forEach\cf9 \strokec9 ((\cf2 \strokec2 child\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 =>\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                         \cf8 \strokec8 // Si muovono solo se il fantasma rosa \'e8 arrivato e il figlio non \'e8 ancora a destinazione\cf2 \cb1 \strokec2 \
\cb3                         \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 pinkGhost\cf9 \strokec9 .\cf2 \strokec2 activated \cf9 \strokec9 &&\cf2 \strokec2  child\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 >\cf2 \strokec2  child\cf9 \strokec9 .\cf2 \strokec2 targetX\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \strokec2  \cf8 \strokec8 // I figli si muovono a sinistra\cf2 \cb1 \strokec2 \
\cb3                             child\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 -=\cf2 \strokec2  child\cf9 \strokec9 .\cf2 \strokec2 speed\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                             ghostsAnimationDone \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // I figli si stanno ancora muovendo\cf2 \cb1 \strokec2 \
\cb3                         \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                             child\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 =\cf2 \strokec2  child\cf9 \strokec9 .\cf2 \strokec2 targetX\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                         \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                         \cf8 \strokec8 // Oscillazione verticale per i figli\cf2 \cb1 \strokec2 \
\cb3                         child\cf9 \strokec9 .\cf2 \strokec2 y \cf9 \strokec9 =\cf2 \strokec2  redGhostY \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 sin\cf9 \strokec9 (\cf13 \strokec13 Date\cf9 \strokec9 .\cf2 \strokec2 now\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.005\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  child\cf9 \strokec9 .\cf2 \strokec2 timeOffset\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 5\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \});\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 \cb1 \
\cb3                 \cf8 \strokec8 // Aggiorna i cuoricini\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 for\cf2 \strokec2  \cf9 \strokec9 (\cf12 \strokec12 let\cf2 \strokec2  i \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \strokec2  i \cf9 \strokec9 <\cf2 \strokec2  hearts\cf9 \strokec9 .\cf2 \strokec2 length\cf9 \strokec9 ;\cf2 \strokec2  i\cf9 \strokec9 ++)\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 const\cf2 \strokec2  heart \cf9 \strokec9 =\cf2 \strokec2  hearts\cf9 \strokec9 [\cf2 \strokec2 i\cf9 \strokec9 ];\cf2 \cb1 \strokec2 \
\cb3                     heart\cf9 \strokec9 .\cf2 \strokec2 y \cf9 \strokec9 +=\cf2 \strokec2  heart\cf9 \strokec9 .\cf2 \strokec2 dy\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     heart\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 +=\cf2 \strokec2  heart\cf9 \strokec9 .\cf2 \strokec2 dx\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     heart\cf9 \strokec9 .\cf2 \strokec2 opacity \cf9 \strokec9 -=\cf2 \strokec2  \cf14 \strokec14 0.005\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3                     \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 heart\cf9 \strokec9 .\cf2 \strokec2 y \cf9 \strokec9 >\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  heart\cf9 \strokec9 .\cf2 \strokec2 size \cf9 \strokec9 ||\cf2 \strokec2  heart\cf9 \strokec9 .\cf2 \strokec2 opacity \cf9 \strokec9 <=\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                         hearts\cf9 \strokec9 .\cf2 \strokec2 splice\cf9 \strokec9 (\cf2 \strokec2 i\cf9 \strokec9 ,\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                         i\cf9 \strokec9 --;\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3                 \cf8 \strokec8 // Controlla se tutte le animazioni visive sono veramente complete\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 let\cf2 \strokec2  allVisualAnimationsComplete \cf9 \strokec9 =\cf2 \strokec2  ghostsAnimationDone \cf9 \strokec9 &&\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 hearts\cf9 \strokec9 .\cf2 \strokec2 length \cf9 \strokec9 ===\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\
\cb3                 \cf8 \strokec8 // Avvia il timer di ritardo solo dopo che tutte le animazioni visive sono complete\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 allVisualAnimationsComplete \cf9 \strokec9 &&\cf2 \strokec2  winMessageDelayTimer \cf9 \strokec9 ===\cf2 \strokec2  \cf12 \strokec12 null\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     winMessageDelayTimer \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 Date\cf9 \strokec9 .\cf2 \strokec2 now\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3                 \cf8 \strokec8 // Mostra la casella del messaggio solo dopo il ritardo\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 winMessageDelayTimer \cf9 \strokec9 !==\cf2 \strokec2  \cf12 \strokec12 null\cf2 \strokec2  \cf9 \strokec9 &&\cf2 \strokec2  \cf13 \strokec13 Date\cf9 \strokec9 .\cf2 \strokec2 now\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  winMessageDelayTimer \cf9 \strokec9 >\cf2 \strokec2  \cf13 \strokec13 WIN_MESSAGE_DELAY\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     messageBox\cf9 \strokec9 .\cf2 \strokec2 style\cf9 \strokec9 .\cf2 \strokec2 display \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 'flex'\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     startButton\cf9 \strokec9 .\cf2 \strokec2 disabled \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     \cb1 \
\cb3                     \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 FINAL_WIN_ANIMATION\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                         messageText\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 `Vittoria Finale! Hai completato tutti i livelli con \cf9 \strokec9 $\{\cf2 \strokec2 score\cf9 \strokec9 \}\cf10 \strokec10  punti! Premi 'F' o tocca per giocare di nuovo.`\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                         startButton\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 "Gioca di nuovo"\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 LEVEL_WIN_ANIMATION\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                         messageText\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 `Livello \cf9 \strokec9 $\{\cf2 \strokec2 currentLevel \cf9 \strokec9 -\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 \}\cf10 \strokec10  Completato! Punti: \cf9 \strokec9 $\{\cf2 \strokec2 score\cf9 \strokec9 \}\cf10 \strokec10 . Premi 'F' o tocca per il Livello \cf9 \strokec9 $\{\cf2 \strokec2 currentLevel\cf9 \strokec9 \}\cf10 \strokec10 !`\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                         startButton\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 "Prossimo Livello"\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                     winMessageDelayTimer \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 null\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     gameStatus \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 PENDING_START\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Transizione allo stato in sospeso in attesa di un flap\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Genera una nuova coppia di tubi.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  generatePipe\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 // Altezza casuale per il tubo superiore, lasciando spazio per il tubo inferiore e lo spazio\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  minHeight \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 50\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  maxHeight \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf13 \strokec13 PIPE_GAP\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  minHeight\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  topPipeHeight \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 floor\cf9 \strokec9 (\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 maxHeight \cf9 \strokec9 -\cf2 \strokec2  minHeight \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 ))\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  minHeight\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3                 pipes\cf9 \strokec9 .\cf2 \strokec2 push\cf9 \strokec9 (\{\cf2 \cb1 \strokec2 \
\cb3                     x\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                     height\cf9 \strokec9 :\cf2 \strokec2  topPipeHeight\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                     gap\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 PIPE_GAP\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                     width\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 PIPE_WIDTH\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                     passed\cf9 \strokec9 :\cf2 \strokec2  \cf12 \strokec12 false\cf2 \strokec2  \cf8 \strokec8 // Per tracciare il punteggio\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \});\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Il ciclo principale del gioco.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  gameLoop\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 switch\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 gameStatus\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 case\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 PLAYING\cf9 \strokec9 :\cf2 \cb1 \strokec2 \
\cb3                         update\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                         draw\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                         \cf12 \strokec12 break\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 case\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 LEVEL_WIN_ANIMATION\cf9 \strokec9 :\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 case\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 FINAL_WIN_ANIMATION\cf9 \strokec9 :\cf2 \cb1 \strokec2 \
\cb3                         updateWinScreen\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                         draw\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                         \cf12 \strokec12 break\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 case\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 IDLE\cf9 \strokec9 :\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 case\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 PENDING_START\cf9 \strokec9 :\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 case\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 GAME_OVER_MESSAGE\cf9 \strokec9 :\cf2 \cb1 \strokec2 \
\cb3                     \cf12 \strokec12 case\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 RESTART_COUNTDOWN\cf9 \strokec9 :\cf2 \cb1 \strokec2 \
\cb3                         draw\cf9 \strokec9 ();\cf2 \strokec2  \cf8 \strokec8 // Disegna solo la scena statica o i messaggi\cf2 \cb1 \strokec2 \
\cb3                         \cf12 \strokec12 break\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 animationFrameId \cf9 \strokec9 =\cf2 \strokec2  requestAnimationFrame\cf9 \strokec9 (\cf2 \strokec2 gameLoop\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Resetta il gioco per una nuova partita completa (score, vite, livello).\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  resetGameForNewPlay\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 player \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     x\cf9 \strokec9 :\cf2 \strokec2  \cf14 \strokec14 50\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                     y\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                     dy\cf9 \strokec9 :\cf2 \strokec2  \cf14 \strokec14 0\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \};\cf2 \cb1 \strokec2 \
\cb3                 pipes \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [];\cf2 \strokec2  \cf8 \strokec8 // Resetta i tubi\cf2 \cb1 \strokec2 \
\cb3                 score \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 lives \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 3\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Resetta le vite a 3 all'inizio di una nuova partita\cf2 \cb1 \strokec2 \
\cb3                 currentLevel \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cb1 \
\cb3                 \cf8 \strokec8 // Imposta le velocit\'e0 dinamiche per il Livello 1\cf2 \cb1 \strokec2 \
\cb3                 currentGravity \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 BASE_GRAVITY\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 GAME_OVERALL_SLOWDOWN_FACTOR\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 currentFlapStrength \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 BASE_FLAP_STRENGTH\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 GAME_OVERALL_SLOWDOWN_FACTOR\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 currentPipeSpeed \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 BASE_PIPE_SPEED\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 GAME_OVERALL_SLOWDOWN_FACTOR\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 currentStarScrollSpeed \cf9 \strokec9 =\cf2 \strokec2  currentPipeSpeed \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 currentPinkGhostSpeed \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 BASE_PINK_GHOST_SPEED\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 GAME_OVERALL_SLOWDOWN_FACTOR\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3                 scoreElem\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 `Punti: \cf9 \strokec9 $\{\cf2 \strokec2 score\cf9 \strokec9 \}\cf10 \strokec10  / \cf9 \strokec9 $\{\cf13 \strokec13 LEVEL_GOALS\cf9 \strokec9 [\cf2 \strokec2 currentLevel \cf9 \strokec9 -\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 ]\}\cf10 \strokec10  (Livello \cf9 \strokec9 $\{\cf2 \strokec2 currentLevel\cf9 \strokec9 \}\cf10 \strokec10 ) Vite: \cf9 \strokec9 $\{\cf2 \strokec2 lives\cf9 \strokec9 \}\cf10 \strokec10 `\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 currentPipeColor \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 PIPE_COLORS_PALETTE\cf9 \strokec9 [\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 floor\cf9 \strokec9 (\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 PIPE_COLORS_PALETTE\cf9 \strokec9 .\cf2 \strokec2 length\cf9 \strokec9 )];\cf2 \cb1 \strokec2 \
\
\cb3                 pinkGhost\cf9 \strokec9 .\cf2 \strokec2 activated \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 hearts \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [];\cf2 \cb1 \strokec2 \
\cb3                 childGhosts \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [];\cf2 \cb1 \strokec2 \
\cb3                 winMessageDelayTimer \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 null\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 lastPipeTime \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Resetta lastPipeTime in modo che il primo tubo venga generato dopo il flap\cf2 \cb1 \strokec2 \
\
\cb3                 gameStatus \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 PENDING_START\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 messageText\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 "Premi 'F' o tocca lo schermo per iniziare!"\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Messaggio di inizio generale\cf2 \cb1 \strokec2 \
\cb3                 startButton\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 "Pronto!"\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 startButton\cf9 \strokec9 .\cf2 \strokec2 disabled \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\cb3                 messageBox\cf9 \strokec9 .\cf2 \strokec2 style\cf9 \strokec9 .\cf2 \strokec2 display \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 'flex'\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 animationFrameId\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     cancelAnimationFrame\cf9 \strokec9 (\cf2 \strokec2 animationFrameId\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 gameLoop\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Resetta il livello corrente (posizione giocatore/pipes) ma mantiene score/vite.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  resetLevelForContinue\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 player \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     x\cf9 \strokec9 :\cf2 \strokec2  \cf14 \strokec14 50\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                     y\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                     dy\cf9 \strokec9 :\cf2 \strokec2  \cf14 \strokec14 0\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \};\cf2 \cb1 \strokec2 \
\cb3                 pipes \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [];\cf2 \strokec2  \cf8 \strokec8 // Resetta i tubi\cf2 \cb1 \strokec2 \
\cb3                 score \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Il punteggio si azzera per livello\cf2 \cb1 \strokec2 \
\cb3                 \cb1 \
\cb3                 \cf8 \strokec8 // Calcola i moltiplicatori di velocit\'e0 per il livello attuale\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 let\cf2 \strokec2  levelMultiplier \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 currentLevel \cf9 \strokec9 ===\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     levelMultiplier \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 LEVEL_SPEED_INCREASE_FACTOR\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 currentLevel \cf9 \strokec9 ===\cf2 \strokec2  \cf14 \strokec14 3\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     levelMultiplier \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 LEVEL_SPEED_INCREASE_FACTOR\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 LEVEL_SPEED_INCREASE_FACTOR\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3                 currentGravity \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 BASE_GRAVITY\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 GAME_OVERALL_SLOWDOWN_FACTOR\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  levelMultiplier\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 currentFlapStrength \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 BASE_FLAP_STRENGTH\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 GAME_OVERALL_SLOWDOWN_FACTOR\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  levelMultiplier\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 currentPipeSpeed \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 BASE_PIPE_SPEED\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 GAME_OVERALL_SLOWDOWN_FACTOR\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  levelMultiplier\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 currentStarScrollSpeed \cf9 \strokec9 =\cf2 \strokec2  currentPipeSpeed \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 currentPinkGhostSpeed \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 BASE_PINK_GHOST_SPEED\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 GAME_OVERALL_SLOWDOWN_FACTOR\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  levelMultiplier\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3                 scoreElem\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 `Punti: \cf9 \strokec9 $\{\cf2 \strokec2 score\cf9 \strokec9 \}\cf10 \strokec10  / \cf9 \strokec9 $\{\cf13 \strokec13 LEVEL_GOALS\cf9 \strokec9 [\cf2 \strokec2 currentLevel \cf9 \strokec9 -\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 ]\}\cf10 \strokec10  (Livello \cf9 \strokec9 $\{\cf2 \strokec2 currentLevel\cf9 \strokec9 \}\cf10 \strokec10 ) Vite: \cf9 \strokec9 $\{\cf2 \strokec2 lives\cf9 \strokec9 \}\cf10 \strokec10 `\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 currentPipeColor \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 PIPE_COLORS_PALETTE\cf9 \strokec9 [\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 floor\cf9 \strokec9 (\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 PIPE_COLORS_PALETTE\cf9 \strokec9 .\cf2 \strokec2 length\cf9 \strokec9 )];\cf2 \cb1 \strokec2 \
\
\cb3                 pinkGhost\cf9 \strokec9 .\cf2 \strokec2 activated \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 hearts \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [];\cf2 \cb1 \strokec2 \
\cb3                 childGhosts \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [];\cf2 \cb1 \strokec2 \
\cb3                 winMessageDelayTimer \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 null\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 lastPipeTime \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Resetta lastPipeTime in modo che il primo tubo venga generato dopo il flap\cf2 \cb1 \strokec2 \
\
\cb3                 gameStatus \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 PENDING_START\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 messageText\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 `Premi 'F' o tocca lo schermo per iniziare il Livello \cf9 \strokec9 $\{\cf2 \strokec2 currentLevel\cf9 \strokec9 \}\cf10 \strokec10 !`\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Messaggio specifico per l'inizio/riavvio del livello\cf2 \cb1 \strokec2 \
\cb3                 startButton\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 "Pronto!"\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 startButton\cf9 \strokec9 .\cf2 \strokec2 disabled \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 messageBox\cf9 \strokec9 .\cf2 \strokec2 style\cf9 \strokec9 .\cf2 \strokec2 display \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 'flex'\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cb1 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 animationFrameId\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     cancelAnimationFrame\cf9 \strokec9 (\cf2 \strokec2 animationFrameId\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 gameLoop\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Termina il gioco e mostra un messaggio.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              * @param \{string\} status - Lo stato finale del gioco ('gameOver', 'levelWin', o 'finalWin').\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  endGame\cf9 \strokec9 (\cf2 \strokec2 status\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 pipes \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [];\cf2 \strokec2  \cf8 \strokec8 // Rimuovi immediatamente tutti i tubi dallo schermo!\cf2 \cb1 \strokec2 \
\cb3                 hearts \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [];\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 for\cf2 \strokec2  \cf9 \strokec9 (\cf12 \strokec12 let\cf2 \strokec2  i \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \strokec2  i \cf9 \strokec9 <\cf2 \strokec2  \cf14 \strokec14 50\cf9 \strokec9 ;\cf2 \strokec2  i\cf9 \strokec9 ++)\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     hearts\cf9 \strokec9 .\cf2 \strokec2 push\cf9 \strokec9 (\cf2 \strokec2 createHeart\cf9 \strokec9 ());\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3                 messageBox\cf9 \strokec9 .\cf2 \strokec2 style\cf9 \strokec9 .\cf2 \strokec2 display \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 'none'\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Nascondi la messageBox all'inizio dell'animazione\cf2 \cb1 \strokec2 \
\cb3                 startButton\cf9 \strokec9 .\cf2 \strokec2 disabled \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 true\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Disabilita il pulsante durante l'animazione/conto alla rovescia\cf2 \cb1 \strokec2 \
\cb3                 startButton\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 "Attendere..."\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  centerX \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  centerY \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf2 \strokec2  \cf9 \strokec9 -\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf2 \strokec2  \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 // Il fantasma rosa si fermer\'e0 alla DESTRA del fantasma rosso\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 const\cf2 \strokec2  pinkGhostTargetX \cf9 \strokec9 =\cf2 \strokec2  centerX \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 5\cf9 \strokec9 ;\cf2 \strokec2  \cb1 \
\
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 status \cf9 \strokec9 ===\cf2 \strokec2  \cf10 \strokec10 'levelWin'\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     currentLevel\cf9 \strokec9 ++;\cf2 \strokec2  \cf8 \strokec8 // Incrementa il livello per la prossima giocata\cf2 \cb1 \strokec2 \
\cb3                     score \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Azzerare il punteggio per il nuovo livello\cf2 \cb1 \strokec2 \
\cb3                     scoreElem\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 `Punti: \cf9 \strokec9 $\{\cf2 \strokec2 score\cf9 \strokec9 \}\cf10 \strokec10  / \cf9 \strokec9 $\{\cf13 \strokec13 LEVEL_GOALS\cf9 \strokec9 [\cf2 \strokec2 currentLevel \cf9 \strokec9 -\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 ]\}\cf10 \strokec10  (Livello \cf9 \strokec9 $\{\cf2 \strokec2 currentLevel\cf9 \strokec9 \}\cf10 \strokec10 ) Vite: \cf9 \strokec9 $\{\cf2 \strokec2 lives\cf9 \strokec9 \}\cf10 \strokec10 `\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Aggiorna la visualizzazione del punteggio immediatamente\cf2 \cb1 \strokec2 \
\cb3                     gameStatus \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 LEVEL_WIN_ANIMATION\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     \cf8 \strokec8 // Posizione iniziale per l'animazione del fantasma rosa per la vittoria di livello\cf2 \cb1 \strokec2 \
\cb3                     pinkGhost\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Inizia dall'estrema destra\cf2 \cb1 \strokec2 \
\cb3                     pinkGhost\cf9 \strokec9 .\cf2 \strokec2 y \cf9 \strokec9 =\cf2 \strokec2  centerY\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     pinkGhost\cf9 \strokec9 .\cf2 \strokec2 activated \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Sar\'e0 true quando raggiunger\'e0 la destinazione\cf2 \cb1 \strokec2 \
\cb3                     childGhosts \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [];\cf2 \strokec2  \cf8 \strokec8 // Nessun fantasma figlio per la vittoria di livello\cf2 \cb1 \strokec2 \
\cb3                     \cf8 \strokec8 // Il testo del messaggio sar\'e0 impostato in updateWinScreen\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 status \cf9 \strokec9 ===\cf2 \strokec2  \cf10 \strokec10 'finalWin'\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     gameStatus \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 FINAL_WIN_ANIMATION\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     \cf8 \strokec8 // Punto di ingresso del fantasma rosa per l'animazione di vittoria finale\cf2 \cb1 \strokec2 \
\cb3                     pinkGhost\cf9 \strokec9 .\cf2 \strokec2 x \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Inizia dall'estrema destra\cf2 \cb1 \strokec2 \
\cb3                     pinkGhost\cf9 \strokec9 .\cf2 \strokec2 y \cf9 \strokec9 =\cf2 \strokec2  centerY\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     pinkGhost\cf9 \strokec9 .\cf2 \strokec2 activated \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     \cb1 \
\cb3                     \cf8 \strokec8 // Fantasmi figli per l'animazione di vittoria finale\cf2 \cb1 \strokec2 \
\cb3                     childGhosts \cf9 \strokec9 =\cf2 \strokec2  \cf9 \strokec9 [\cf2 \cb1 \strokec2 \
\cb3                         \cf9 \strokec9 \{\cf2 \strokec2  \cb1 \
\cb3                             x\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 50\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Inizia 50px a destra del pink ghost iniziale\cf2 \cb1 \strokec2 \
\cb3                             y\cf9 \strokec9 :\cf2 \strokec2  centerY \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.2\cf9 \strokec9 ,\cf2 \strokec2  \cb1 \
\cb3                             color\cf9 \strokec9 :\cf2 \strokec2  \cf10 \strokec10 '#e53e3e'\cf9 \strokec9 ,\cf2 \strokec2  \cb1 \
\cb3                             speed\cf9 \strokec9 :\cf2 \strokec2  currentPinkGhostSpeed \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.8\cf9 \strokec9 ,\cf2 \cb1 \strokec2 \
\cb3                             targetX\cf9 \strokec9 :\cf2 \strokec2  pinkGhostTargetX \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 CHILD_GHOST_SIZE_FACTOR\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 1.5\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Target a destra del fantasma rosa finale\cf2 \cb1 \strokec2 \
\cb3                             timeOffset\cf9 \strokec9 :\cf2 \strokec2  \cf14 \strokec14 0\cf2 \strokec2  \cb1 \
\cb3                         \cf9 \strokec9 \},\cf2 \strokec2  \cb1 \
\cb3                         \cf9 \strokec9 \{\cf2 \strokec2  \cb1 \
\cb3                             x\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf2 \strokec2  \cf9 \strokec9 +\cf2 \strokec2  \cf14 \strokec14 100\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Inizia 100px a destra del pink ghost iniziale\cf2 \cb1 \strokec2 \
\cb3                             y\cf9 \strokec9 :\cf2 \strokec2  centerY \cf9 \strokec9 -\cf2 \strokec2  \cf13 \strokec13 PLAYER_HEIGHT\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.2\cf9 \strokec9 ,\cf2 \strokec2  \cb1 \
\cb3                             color\cf9 \strokec9 :\cf2 \strokec2  \cf10 \strokec10 '#ff69b4'\cf9 \strokec9 ,\cf2 \strokec2  \cb1 \
\cb3                             speed\cf9 \strokec9 :\cf2 \strokec2  currentPinkGhostSpeed \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.8\cf9 \strokec9 ,\cf2 \strokec2  \cb1 \
\cb3                             targetX\cf9 \strokec9 :\cf2 \strokec2  pinkGhostTargetX \cf9 \strokec9 +\cf2 \strokec2  \cf13 \strokec13 PLAYER_WIDTH\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 CHILD_GHOST_SIZE_FACTOR\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf14 \strokec14 0.5\cf9 \strokec9 ,\cf2 \strokec2  \cf8 \strokec8 // Target a destra del fantasma rosa finale\cf2 \cb1 \strokec2 \
\cb3                             timeOffset\cf9 \strokec9 :\cf2 \strokec2  \cf13 \strokec13 Math\cf9 \strokec9 .\cf13 \strokec13 PI\cf2 \strokec2  \cb1 \
\cb3                         \cf9 \strokec9 \}\cf2 \strokec2  \cb1 \
\cb3                     \cf9 \strokec9 ];\cf2 \cb1 \strokec2 \
\
\cb3                 \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 status \cf9 \strokec9 ===\cf2 \strokec2  \cf10 \strokec10 'gameOver'\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \strokec2  \cf8 \strokec8 // Il giocatore ha colpito un ostacolo\cf2 \cb1 \strokec2 \
\cb3                     lives\cf9 \strokec9 --;\cf2 \cb1 \strokec2 \
\cb3                     scoreElem\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 `Punti: \cf9 \strokec9 $\{\cf2 \strokec2 score\cf9 \strokec9 \}\cf10 \strokec10  / \cf9 \strokec9 $\{\cf13 \strokec13 LEVEL_GOALS\cf9 \strokec9 [\cf2 \strokec2 currentLevel \cf9 \strokec9 -\cf2 \strokec2  \cf14 \strokec14 1\cf9 \strokec9 ]\}\cf10 \strokec10  (Livello \cf9 \strokec9 $\{\cf2 \strokec2 currentLevel\cf9 \strokec9 \}\cf10 \strokec10 ) Vite: \cf9 \strokec9 $\{\cf2 \strokec2 lives\cf9 \strokec9 \}\cf10 \strokec10 `\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     \cb1 \
\cb3                     \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 lives \cf9 \strokec9 >\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                         gameStatus \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 GAME_OVER_MESSAGE\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Pausa e richiesta di continuare\cf2 \cb1 \strokec2 \
\cb3                         messageText\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 `Hai perso una vita! Ti restano \cf9 \strokec9 $\{\cf2 \strokec2 lives\cf9 \strokec9 \}\cf10 \strokec10  vite. Premi 'F' o tocca per continuare.`\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                         startButton\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 "Continua"\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Testo del pulsante\cf2 \cb1 \strokec2 \
\cb3                         startButton\cf9 \strokec9 .\cf2 \strokec2 disabled \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 false\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Abilita il pulsante\cf2 \cb1 \strokec2 \
\cb3                         messageBox\cf9 \strokec9 .\cf2 \strokec2 style\cf9 \strokec9 .\cf2 \strokec2 display \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 'flex'\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Mostra la casella del messaggio\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \strokec2  \cf8 \strokec8 // Tutte le vite perse\cf2 \cb1 \strokec2 \
\cb3                         gameStatus \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 RESTART_COUNTDOWN\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Avvia il conto alla rovescia per il riavvio automatico\cf2 \cb1 \strokec2 \
\cb3                         messageText\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 `Game Over! Punti: \cf9 \strokec9 $\{\cf2 \strokec2 score\cf9 \strokec9 \}\cf10 \strokec10 . Non ti restano vite. Riavvio in 3...`\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                         startButton\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 "Riavvio in 3..."\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                         startButton\cf9 \strokec9 .\cf2 \strokec2 disabled \cf9 \strokec9 =\cf2 \strokec2  \cf12 \strokec12 true\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Il pulsante rimane disabilitato durante il conto alla rovescia\cf2 \cb1 \strokec2 \
\
\cb3                         \cf12 \strokec12 let\cf2 \strokec2  countdown \cf9 \strokec9 =\cf2 \strokec2  \cf14 \strokec14 3\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                         \cf12 \strokec12 const\cf2 \strokec2  countdownInterval \cf9 \strokec9 =\cf2 \strokec2  setInterval\cf9 \strokec9 (()\cf2 \strokec2  \cf9 \strokec9 =>\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                             countdown\cf9 \strokec9 --;\cf2 \cb1 \strokec2 \
\cb3                             \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 countdown \cf9 \strokec9 >\cf2 \strokec2  \cf14 \strokec14 0\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                                 startButton\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 `Riavvio in \cf9 \strokec9 $\{\cf2 \strokec2 countdown\cf9 \strokec9 \}\cf10 \strokec10 ...`\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                             \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                                 clearInterval\cf9 \strokec9 (\cf2 \strokec2 countdownInterval\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                                 resetGameForNewPlay\cf9 \strokec9 ();\cf2 \strokec2  \cf8 \strokec8 // Riavvia completamente il gioco dal Livello 1\cf2 \cb1 \strokec2 \
\cb3                             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                         \cf9 \strokec9 \},\cf2 \strokec2  \cf14 \strokec14 1000\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3                     \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 // Listener di eventi per l'azione di "flap" (click, touch, tasto 'f')\cf2 \cb1 \strokec2 \
\cb3             \cf12 \strokec12 function\cf2 \strokec2  flap\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 PENDING_START\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     gameStatus \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 PLAYING\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     messageBox\cf9 \strokec9 .\cf2 \strokec2 style\cf9 \strokec9 .\cf2 \strokec2 display \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 'none'\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                     player\cf9 \strokec9 .\cf2 \strokec2 dy \cf9 \strokec9 =\cf2 \strokec2  currentFlapStrength\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Applica il flap iniziale\cf2 \cb1 \strokec2 \
\cb3                     lastPipeTime \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 Date\cf9 \strokec9 .\cf2 \strokec2 now\cf9 \strokec9 ();\cf2 \strokec2  \cf8 \strokec8 // Inizia a generare i tubi\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 GAME_OVER_MESSAGE\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     \cf8 \strokec8 // Se l'utente preme il tasto di flap mentre viene mostrato il messaggio 'hai perso una vita',\cf2 \cb1 \strokec2 \
\cb3                     \cf8 \strokec8 // attiva il reset del livello e attendi un nuovo flap.\cf2 \cb1 \strokec2 \
\cb3                     resetLevelForContinue\cf9 \strokec9 ();\cf2 \strokec2  \cb1 \
\cb3                 \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 PLAYING\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     \cf8 \strokec8 // Flap normale durante il gameplay\cf2 \cb1 \strokec2 \
\cb3                     player\cf9 \strokec9 .\cf2 \strokec2 dy \cf9 \strokec9 =\cf2 \strokec2  currentFlapStrength\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 // Altri stati (IDLE, animazioni, conto alla rovescia) non rispondono al flap direttamente a PLAYING.\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 // Listener di eventi per click e touch per il flap\cf2 \cb1 \strokec2 \
\cb3             canvas\cf9 \strokec9 .\cf2 \strokec2 addEventListener\cf9 \strokec9 (\cf10 \strokec10 'click'\cf9 \strokec9 ,\cf2 \strokec2  flap\cf9 \strokec9 );\cf2 \cb1 \strokec2 \
\cb3             canvas\cf9 \strokec9 .\cf2 \strokec2 addEventListener\cf9 \strokec9 (\cf10 \strokec10 'touchstart'\cf9 \strokec9 ,\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 e\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 =>\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 e\cf9 \strokec9 .\cf2 \strokec2 preventDefault\cf9 \strokec9 ();\cf2 \strokec2  \cf8 \strokec8 // Impedisce lo scrolling sui dispositivi touch\cf2 \cb1 \strokec2 \
\cb3                 flap\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \},\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \strokec2  passive\cf9 \strokec9 :\cf2 \strokec2  \cf12 \strokec12 false\cf2 \strokec2  \cf9 \strokec9 \});\cf2 \strokec2  \cf8 \strokec8 // 'passive: false' \'e8 necessario per e.preventDefault() in touchstart\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 // Listener di eventi per il tasto della tastiera 'f'\cf2 \cb1 \strokec2 \
\cb3             document\cf9 \strokec9 .\cf2 \strokec2 addEventListener\cf9 \strokec9 (\cf10 \strokec10 'keydown'\cf9 \strokec9 ,\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 e\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 =>\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 e\cf9 \strokec9 .\cf2 \strokec2 key \cf9 \strokec9 ===\cf2 \strokec2  \cf10 \strokec10 'f'\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     flap\cf9 \strokec9 ();\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \});\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 // Listener per il pulsante "Inizia Gioco" / "Continua" / "Gioca di nuovo" / "Prossimo Livello"\cf2 \cb1 \strokec2 \
\cb3             startButton\cf9 \strokec9 .\cf2 \strokec2 addEventListener\cf9 \strokec9 (\cf10 \strokec10 'click'\cf9 \strokec9 ,\cf2 \strokec2  \cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 =>\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 // Questo pulsante ora serve solo a "preparare" il gioco/livello, non a farlo partire immediatamente\cf2 \cb1 \strokec2 \
\cb3                 \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 IDLE\cf2 \strokec2  \cf9 \strokec9 ||\cf2 \strokec2  gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 FINAL_WIN_ANIMATION\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     resetGameForNewPlay\cf9 \strokec9 ();\cf2 \strokec2  \cf8 \strokec8 // Riavvio completo del gioco\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \strokec2  \cf12 \strokec12 else\cf2 \strokec2  \cf12 \strokec12 if\cf2 \strokec2  \cf9 \strokec9 (\cf2 \strokec2 gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 GAME_OVER_MESSAGE\cf2 \strokec2  \cf9 \strokec9 ||\cf2 \strokec2  gameStatus \cf9 \strokec9 ===\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 LEVEL_WIN_ANIMATION\cf9 \strokec9 )\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                     resetLevelForContinue\cf9 \strokec9 ();\cf2 \strokec2  \cf8 \strokec8 // Continua dal livello corrente\cf2 \cb1 \strokec2 \
\cb3                 \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\cb3                 \cf8 \strokec8 // Dopo questo, il gameStatus sar\'e0 PENDING_START e attender\'e0 un flap\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \});\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 /**\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8              * Inizializza la configurazione del gioco.\cf2 \cb1 \strokec2 \
\cf8 \cb3 \strokec8              */\cf2 \cb1 \strokec2 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3             \cf12 \strokec12 function\cf2 \strokec2  initGame\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 \{\cf2 \cb1 \strokec2 \
\cb3                 canvas\cf9 \strokec9 .\cf2 \strokec2 width \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 CANVAS_WIDTH\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 canvas\cf9 \strokec9 .\cf2 \strokec2 height \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 CANVAS_HEIGHT\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 generateStars\cf9 \strokec9 ();\cf2 \strokec2  \cf8 \strokec8 // Genera le stelle una volta all'inizio\cf2 \cb1 \strokec2 \
\
\cb3                 \cf8 \strokec8 // Inizializza le velocit\'e0 per lo stato iniziale/livello 1\cf2 \cb1 \strokec2 \
\cb3                 currentGravity \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 BASE_GRAVITY\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 GAME_OVERALL_SLOWDOWN_FACTOR\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 currentFlapStrength \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 BASE_FLAP_STRENGTH\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 GAME_OVERALL_SLOWDOWN_FACTOR\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 currentPipeSpeed \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 BASE_PIPE_SPEED\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 GAME_OVERALL_SLOWDOWN_FACTOR\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 currentStarScrollSpeed \cf9 \strokec9 =\cf2 \strokec2  currentPipeSpeed \cf9 \strokec9 /\cf2 \strokec2  \cf14 \strokec14 2\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 currentPinkGhostSpeed \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 BASE_PINK_GHOST_SPEED\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 GAME_OVERALL_SLOWDOWN_FACTOR\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3                 messageText\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 "Benvenuto a Flappy Fantasma! Premi 'Inizia Gioco' per prepararti."\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 startButton\cf9 \strokec9 .\cf2 \strokec2 textContent \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 "Inizia Gioco"\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 messageBox\cf9 \strokec9 .\cf2 \strokec2 style\cf9 \strokec9 .\cf2 \strokec2 display \cf9 \strokec9 =\cf2 \strokec2  \cf10 \strokec10 'flex'\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\cb3                 \cb1 \
\cb3                 \cf8 \strokec8 // Inizializza il colore dei tubi per la schermata iniziale prima che il gioco inizi\cf2 \cb1 \strokec2 \
\cb3                 currentPipeColor \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 PIPE_COLORS_PALETTE\cf9 \strokec9 [\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 floor\cf9 \strokec9 (\cf13 \strokec13 Math\cf9 \strokec9 .\cf2 \strokec2 random\cf9 \strokec9 ()\cf2 \strokec2  \cf9 \strokec9 *\cf2 \strokec2  \cf13 \strokec13 PIPE_COLORS_PALETTE\cf9 \strokec9 .\cf2 \strokec2 length\cf9 \strokec9 )];\cf2 \cb1 \strokec2 \
\cb3                 \cb1 \
\cb3                 gameStatus \cf9 \strokec9 =\cf2 \strokec2  \cf13 \strokec13 GAME_STATE\cf9 \strokec9 .\cf13 \strokec13 IDLE\cf9 \strokec9 ;\cf2 \strokec2  \cf8 \strokec8 // Stato iniziale\cf2 \cb1 \strokec2 \
\cb3                 gameLoop\cf9 \strokec9 ();\cf2 \strokec2  \cf8 \strokec8 // Avvia il gameLoop per disegnare la schermata iniziale\cf2 \cb1 \strokec2 \
\cb3             \cf9 \strokec9 \}\cf2 \cb1 \strokec2 \
\
\cb3             \cf8 \strokec8 // Inizializza il gioco quando la finestra viene caricata\cf2 \cb1 \strokec2 \
\cb3             window\cf9 \strokec9 .\cf2 \strokec2 onload \cf9 \strokec9 =\cf2 \strokec2  initGame\cf9 \strokec9 ;\cf2 \cb1 \strokec2 \
\
\cb3         \cf6 \strokec6 </\cf4 \strokec4 script\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3     \cf6 \strokec6 </\cf4 \strokec4 body\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3     \cf6 \strokec6 </\cf4 \strokec4 html\cf6 \strokec6 >\cf2 \cb1 \strokec2 \
\cb3     \cb1 \
}